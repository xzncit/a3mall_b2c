(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/cart/confirm"],{1268:function(t,s,e){"use strict";(function(t){e("e7e3");n(e("66fd"));var s=n(e("6c08"));function n(t){return t&&t.__esModule?t:{default:t}}t(s.default)}).call(this,e("543d")["createPage"])},"188e":function(t,s,e){"use strict";e.d(s,"b",(function(){return i})),e.d(s,"c",(function(){return a})),e.d(s,"a",(function(){return n}));var n={navbar:function(){return Promise.all([e.e("common/vendor"),e.e("components/navbar/navbar")]).then(e.bind(null,"c4a9"))},couponList:function(){return e.e("components/coupon-list/coupon-list").then(e.bind(null,"e2bc"))},addressList:function(){return e.e("components/address-list/address-list").then(e.bind(null,"8fac"))}},i=function(){var t=this,s=t.$createElement;t._self._c;t._isMounted||(t.e0=function(s){t.isAddressStatus=!0},t.e1=function(s){t.isCouponStatus=!t.isCouponStatus})},a=[]},"4ff5":function(t,s,e){},"6c08":function(t,s,e){"use strict";e.r(s);var n=e("188e"),i=e("c8aa");for(var a in i)"default"!==a&&function(t){e.d(s,t,(function(){return i[t]}))}(a);e("d799");var r,o=e("f0c5"),d=Object(o["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],r);s["default"]=d.exports},c8aa:function(t,s,e){"use strict";e.r(s);var n=e("ed91"),i=e.n(n);for(var a in n)"default"!==a&&function(t){e.d(s,t,(function(){return n[t]}))}(a);s["default"]=i.a},d799:function(t,s,e){"use strict";var n=e("4ff5"),i=e.n(n);i.a},ed91:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var n,i=a(e("1323"));function a(t){return t&&t.__esModule?t:{default:t}}function r(t,s,e){return s in t?Object.defineProperty(t,s,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[s]=e,t}var o=function(){e.e("components/tool/info").then(function(){return resolve(e("86f1"))}.bind(null,e)).catch(e.oe)},d=function(){e.e("components/tool/loading").then(function(){return resolve(e("d119"))}.bind(null,e)).catch(e.oe)},u=function(){Promise.all([e.e("common/vendor"),e.e("components/navbar/navbar")]).then(function(){return resolve(e("c4a9"))}.bind(null,e)).catch(e.oe)},c={components:{MallInfo:o,loading:d,navbar:u},data:function(){return{scrollNum:0,shippingType:1,isShipping:0,store:{id:"",name:"",tel:"",address:""},isLoading:!0,loadingColor:"rgba(255,255,255,1)",loadingText:"正在加载订单中",isCouponStatus:!1,isAddressStatus:!1,bonusText:"请选择",address:{id:"",name:"",tel:"",address:""},chosenAddressId:"0",bonusId:"0",addressList:[],orderData:{item:{},real_amount:0,real_freight:0,payable_amount:0,order_amount:0,users_price:0,real_point:0,users_point:0,type:0},remarks:"",payment:"wechat",coupons:[],params:null,orderBtnFlag:!1,providerList:[]}},onLoad:function(t){var s=this,e=t.type,n=t.id,a={id:n,type:e};this.$utils.in_array(e,["buy"])&&(a.sku_id=t.sku_id,a.num=t.num,t.kid&&(a.kid=t.kid)),a.shipping_type=this.shippingType,this.params=a,i.default.getPaymentList().then((function(t){s.providerList=t}))},onShow:function(){var t=this;this.$nextTick((function(){var s=t.$storage.getJson("users");null==s?t.$utils.navigateTo("public/login"):t.onLoadOrder()}))},onPageScroll:function(t){this.scrollNum=t.scrollTop},methods:(n={onSelectedAddress:function(t){this.isAddressStatus=!1,this.chosenAddressId=t.id,this.params.address_id=this.chosenAddressId,this.address=t,delete this.params.store_id,this.onLoadOrder()},onLoadOrder:function(){var t=this;this.$utils.showLoading(),this.$http.getCartConfirm(this.params).then((function(s){t.$utils.hideLoading(),s.status?(t.orderData=s.data,t.isShipping=parseInt(s.data.is_shipping),t.storeList=s.data.store,t.addressList=s.data.address.list,void 0==s.data.address.default||s.data.address.default.length<=0?void 0!=s.data.address.list[0]&&(t.address=s.data.address.list[0],t.chosenAddressId=t.address.id):(t.chosenAddressId=s.data.address.default.id,t.address=s.data.address.default),t.coupons=s.data.bonus,"请选择"==t.bonusText&&(t.bonusText=s.data.bonus.length<=0?"暂无优惠劵":s.data.bonus.length+"张可用"),t.isLoading=!1):(t.isLoading=!1,t.$storage.set("order_msg",s.info),t.$utils.redirectTo("cart/msg"))}))},onOrderSubmit:function(){var t=this;if(this.orderBtnFlag)return!1;if(this.orderData.real_point>this.orderData.users_point)return this.$utils.msg("您的积分不足，不能购买此商品"),!1;if(2==this.shippingType&&""==this.store.id)return this.$utils.msg("请先选择自提门店"),!1;this.orderBtnFlag=!0,this.isLoading=!0,this.loadingColor="rgba(255,255,255,0.3)",this.loadingText="正在提交订单中";var s={};Object.assign(s,{id:this.params.id,type:this.params.type,address_id:this.chosenAddressId,bonus_id:this.bonusId,payment:this.payment,remarks:this.remarks,source:i.default.getPaymentType()},this.params),this.$http.createOrder(s).then((function(s){t.isLoading=!1,s.status?i.default.crreateOrder(s.data,!0):t.$utils.msg(s.info),t.orderBtnFlag=!1})).catch((function(s){t.isLoading=!1,t.$utils.msg("网络连接错误，请检查网络是否可用"),t.orderBtnFlag=!1}))},selectPayment:function(t){this.payment=t},onCoupons:function(t){this.isCouponStatus=!1,this.params.bonus_id=t.id,this.bonusText=t.value,this.bonusId=t.id,this.onLoadOrder()}},r(n,"onSelectedAddress",(function(t){this.isAddressStatus=!1,this.chosenAddressId=t.id,this.params.address_id=this.chosenAddressId,this.address=t,delete this.params.store_id,this.onLoadOrder()})),r(n,"onAdd",(function(){this.$storage.set("ORDER_CONFIRM_SELECT",!0),this.$utils.navigateTo("ucenter/address_editor")})),n)};s.default=c}},[["1268","common/runtime","common/vendor"]]]);